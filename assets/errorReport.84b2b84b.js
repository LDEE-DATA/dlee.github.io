import{s as f}from"./request.ff065028.js";import{e as N,f as E,h as S,l as h,o as d,c as _,a as b,m as n,n as l,t as g,z as k,y,N as B,F as V,ao as D,E as m,a3 as A,D as O,G as R,_ as U}from"./index.b14b041f.js";function x(p){const a=new Date(p),c=(Date.now()-a.getTime())/1e3;return c<30?"\u521A\u521A":c<3600?Math.ceil(c/60)+"\u5206\u949F\u524D":c<3600*24?Math.ceil(c/3600)+"\u5C0F\u65F6\u524D":c<3600*24*2?"1\u5929\u524D":a.getFullYear()+"\u5E74"+a.getMonth()+1+"\u6708"+a.getDate()+"\u65E5"+a.getHours()+"\u65F6"+a.getMinutes()+"\u5206"}const H=p=>(O("data-v-5abb30bb"),p=p(),R(),p),j=H(()=>b("div",{class:"title"},"\u7D20\u6750\u62A5\u8BEF",-1)),G={class:"handle"},K={class:"content"},L={key:0},P={key:1,style:{color:"red"}},Y={key:2,style:{color:"green"}},q={key:0,style:{color:"red"}},J={key:1,style:{color:"green"}},Q={class:"page"},W=N({__name:"errorReport",setup(p){const a=E([]),i=E({}),c=()=>{a.value.filter(e=>{if(e.status==1&&e.checkor.indexOf(D())!=-1)return e}).forEach(e=>v(e))},T=e=>{f.get("/blockTodo/page/"+e).then(o=>{i.value=o.data,a.value=i.value.records,a.value.forEach(s=>{s.time=x(s.time)})})},F=()=>{f.get("/blockTodo/page/1").then(e=>{i.value=e.data,a.value=i.value.records,a.value.forEach(u=>{u.time=x(u.time)})})},v=e=>{delete e.time,f.post("/blockTodo",e).then(o=>{let u=o;u.data?(m.success("\u6210\u529F"),F()):m.warning(u.msg)}).catch(()=>m.error("\u8BF7\u6C42\u51FA\u9519"))},M=e=>{A.prompt("\u9A73\u56DE\u7406\u7531","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88"}).then(({value:o})=>{delete e.time,e.remark=o,f.post("/blockTodo",e).then(u=>{let s=u;s.data?(m.success("\u6210\u529F"),F()):m.warning(s.msg)}).catch(()=>m.error("\u8BF7\u6C42\u51FA\u9519"))})},w=e=>{let o=D();return e.checkor.indexOf(o)!=-1},I=e=>{let o=e.taskTodo.paperId;f.get("/crime/paper/"+o).then(u=>{let s=u.data,r=`<div style="">
                            <div><span style="font-weight:bold">\u57FA\u672C\u4E8B\u5B9E\uFF1A</span>${s.baseInfo}</div>
                            <div><span style="font-weight:bold">\u88C1\u5224\u8FC7\u7A0B\uFF1A</span>${s.analysisProcess}</div>
                            <div><span style="font-weight:bold">\u88C1\u5224\u7ED3\u679C\uFF1A</span>${s.result}</div></div>`;A.alert(r,s.name,{confirmButtonText:"OK",dangerouslyUseHTMLString:!0})})};return S(()=>{F()}),(e,o)=>{const u=h("el-button"),s=h("el-popconfirm"),r=h("el-table-column"),$=h("el-table"),z=h("el-pagination");return d(),_(V,null,[j,b("div",G,[n(s,{title:"\u786E\u8BA4\u8981\u4F7F\u7528\u8BE5\u9879?",onConfirm:o[0]||(o[0]=t=>c())},{reference:l(()=>[n(u,{type:"warning"},{default:l(()=>[g("\u4E00\u952E\u540C\u610F")]),_:1})]),_:1})]),b("div",K,[n($,{data:a.value,style:{width:"100%"},stripe:!0},{default:l(()=>[n(r,{type:"index"}),n(r,{prop:"reportor",label:"\u63D0\u4EA4\u4EBA",sortable:"",width:"150"}),n(r,{prop:"checkor",label:"\u68C0\u67E5\u4EBA",sortable:"",width:"150"}),n(r,{prop:"reason",label:"\u62A5\u8BEF\u539F\u56E0",sortable:"",width:"300"}),n(r,{prop:"time",label:"\u66F4\u65B0\u65F6\u95F4",sortable:"",width:"200"}),n(r,{label:"\u72B6\u6001",sortable:"",width:"100"},{default:l(t=>[t.row.status==1?(d(),_("span",L,"\u5904\u7406\u4E2D")):t.row.status==-1?(d(),_("span",P,"\u88AB\u9A73\u56DE")):(d(),_("span",Y,"\u5DF2\u5B8C\u6210"))]),_:1}),n(r,{label:"\u53CD\u9988\u7ED3\u679C"},{default:l(t=>[t.row.status==-1?(d(),_("span",q,k(t.row.remark),1)):(d(),_("span",J,k(t.row.remark),1))]),_:1}),n(r,{align:"right",width:"200",fixed:"right"},{default:l(t=>[n(u,{size:"small",type:"info",onClick:C=>I(t.row)},{default:l(()=>[g("\u8BE6\u60C5")]),_:2},1032,["onClick"]),t.row.status==1&&w(t.row)?(d(),y(u,{key:0,size:"small",type:"success",onClick:C=>v(t.row)},{default:l(()=>[g("\u540C\u610F")]),_:2},1032,["onClick"])):B("",!0),t.row.status==1&&w(t.row)?(d(),y(u,{key:1,size:"small",type:"danger",onClick:C=>M(t.row)},{default:l(()=>[g("\u9A73\u56DE")]),_:2},1032,["onClick"])):B("",!0)]),_:1})]),_:1},8,["data"]),b("div",Q,[n(z,{"current-page":i.value.current,"onUpdate:current-page":o[1]||(o[1]=t=>i.value.current=t),"page-size":15,background:!0,layout:"prev, pager, next, jumper",total:i.value.total,onCurrentChange:T},null,8,["current-page","total"])])])],64)}}});const ee=U(W,[["__scopeId","data-v-5abb30bb"]]);export{ee as default};
